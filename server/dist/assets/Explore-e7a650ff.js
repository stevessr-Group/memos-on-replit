import{u as A,f as L,w as N,x as T,r as n,i as b,y as o,T as u,j as t,M as C,E as k,n as R}from"./index-b7fe78e2.js";import{M as v}from"./MemoFilter-199f87c6.js";import{M as I}from"./Memo-46d0cf53.js";import"./MemoEditorDialog-85474b63.js";const D=()=>{const{t:c}=A(),p=L(),d=N(),i=T(),g=d.state,[s,m]=n.useState({memos:[]}),[M,a]=n.useState(!1),f=b();n.useEffect(()=>{i.fetchAllMemos(o,0).then(e=>{e.length<o&&a(!0),m({memos:e}),f.setFinish()})},[p]);const{tag:r,text:w}=g,j=(!!(r||w)?s.memos.filter(e=>{let x=!0;if(r){const h=new Set;for(const S of Array.from(e.content.match(new RegExp(u,"g"))??[])){const E=S.replace(u,"$1").trim().split("/");let l="";for(const F of E)l+=F,h.add(l),l+="/"}h.has(r)||(x=!1)}return x}):s.memos).filter(e=>e.rowStatus==="NORMAL"),y=async()=>{try{const e=await i.fetchAllMemos(o,s.memos.length);e.length<o?a(!0):a(!1),m({memos:s.memos.concat(e)})}catch(e){console.error(e),R.error(e.response.data.message)}};return t.jsxs("section",{className:"w-full max-w-3xl min-h-full flex flex-col justify-start items-center px-4 sm:px-2 sm:pt-4 pb-8 bg-zinc-100 dark:bg-zinc-800",children:[t.jsx(C,{showSearch:!1}),!f.isLoading&&t.jsxs("main",{className:"relative w-full h-auto flex flex-col justify-start items-start",children:[t.jsx(v,{}),j.map(e=>t.jsx(I,{memo:e,showCreator:!0},`${e.id}-${e.displayTs}`)),M?s.memos.length===0&&t.jsxs("div",{className:"w-full mt-16 mb-8 flex flex-col justify-center items-center italic",children:[t.jsx(k,{}),t.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:c("message.no-data")})]}):t.jsx("p",{className:"m-auto text-center mt-4 italic cursor-pointer text-gray-500 hover:text-green-600",onClick:y,children:c("memo.fetch-more")})]})]})};export{D as default};
